{"version":3,"mappings":"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","names":["routes","path","component","_steps_component__WEBPACK_IMPORTED_MODULE_0__","StepsRoutingModule","imports","_angular_router__WEBPACK_IMPORTED_MODULE_3__","exports","StepsComponent","footerService","journeyService","ngZone","router","eventManager","eventTracking","utilityService","_capacitor_keyboard__WEBPACK_IMPORTED_MODULE_6__","rxjs__WEBPACK_IMPORTED_MODULE_11__","isWeb","getIsWeb","slideOpts","slidesPerView","centeredSlides","spaceBetween","noSwipingSelector","longSwipes","longSwipesMs","longSwipesRatio","shortSwipes","subscription","add","createSubscriber","_shared_lib_constants_event_keys__WEBPACK_IMPORTED_MODULE_8__","subscribe","leaveJourney","refreshJourneyStatusPublisher","createPublisher","scrollToTopPublisher","fetchJourneys","currentJourney","getCurrentJourney","journey","steps","publish","type","_shared_lib_modules_footer_constants_footerType_enum__WEBPACK_IMPORTED_MODULE_2__","publishSelectedTab","swipeEnabledList","Array","length","fill","progressBarSteps","JSON","parse","stringify","status","_shared_lib_constants_status_enum__WEBPACK_IMPORTED_MODULE_4__","updateStepStatuses","undefined","publishCurrentStep","currentStep","saveLastStep","setTimeout","slides","slideTo","lastModifiedStepIndex","i","swiper","allowTouchMove","run","keyboard","hide","currentStepIndex","activeIndex","initialSlide","finishJourney","newIndex","prevIndex","isCompleted","updateStatuses","stepsToSave","completedStep","getUpdatedCompleteStep","push","removeContent","eventName","journeyID","journeyName","saveProgress","updateJourneySteps","index","journeyStep","answer","value","updateInd","event","slideNext","route","stepToSave","isSummaryStepCompleted","navigateByUrl","navigate","queryParams","journeyType","stepEls","get","nativeElement","scrollIntoView","behavior","block","inline","swipeEnabledEvent","swipeEnabled","setCurrentJourney","unsubscribe","_shared_lib_modules_footer_services_footer_type_footer_type_service__WEBPACK_IMPORTED_MODULE_3__","_shared_lib_services_journey_journey_service__WEBPACK_IMPORTED_MODULE_5__","_angular_core__WEBPACK_IMPORTED_MODULE_12__","_angular_router__WEBPACK_IMPORTED_MODULE_13__","_shared_lib_modules_event_manager_event_manager_event_manager_service__WEBPACK_IMPORTED_MODULE_7__","_shared_lib_services_event_tracker_event_tracking_service__WEBPACK_IMPORTED_MODULE_9__","_shared_lib_services_utility_utility_service__WEBPACK_IMPORTED_MODULE_10__","args","read","selector","template","StepsModule","declarations","_ionic_angular__WEBPACK_IMPORTED_MODULE_7__","_angular_common__WEBPACK_IMPORTED_MODULE_8__","_steps_routing_module__WEBPACK_IMPORTED_MODULE_1__","swiper_angular__WEBPACK_IMPORTED_MODULE_9__","_shared_lib_components_step_progress_bar_step_progress_bar_module__WEBPACK_IMPORTED_MODULE_2__","_step_step_module__WEBPACK_IMPORTED_MODULE_3__","_components_modal_modal_module__WEBPACK_IMPORTED_MODULE_4__","schemas","EventTrackingService","baseService","_shared_lib_services_account_constants_endpoints__WEBPACK_IMPORTED_MODULE_0__","endPoints","appendBaseUrlToEndpoints","postData","createdBy","getSubscriberKey","subscriberKey","passThruAttributes","attributeName","attributeValue","post","subscriberKeyPromise","_shared_lib_services_base_base_factory_provider__WEBPACK_IMPORTED_MODULE_1__","_shared_lib_services_utility_utility_service__WEBPACK_IMPORTED_MODULE_2__","providedIn","__webpack_exports__"],"sources":["webpack:///shared-lib/modules/journeys/journey/steps/steps-routing.module.ts","webpack:///shared-lib/modules/journeys/journey/steps/steps.component.ts","webpack:///shared-lib/modules/journeys/journey/steps/steps.module.ts","webpack:///shared-lib/services/event-tracker/event-tracking.service.ts","webpack:///shared-lib/modules/journeys/journey/steps/steps.component.html"],"sourcesContent":["import {NgModule} from '@angular/core';\nimport {Routes, RouterModule} from '@angular/router';\nimport {StepsComponent} from './steps.component';\n\nconst routes: Routes = [\n  {\n    path: '',\n    component: StepsComponent,\n  },\n];\n\n@NgModule({\n  imports: [RouterModule.forChild(routes)],\n  exports: [RouterModule],\n})\nexport class StepsRoutingModule {}\n","import {\n  Component,\n  ElementRef,\n  NgZone,\n  OnInit,\n  QueryList,\n  ViewChildren,\n} from '@angular/core';\nimport {Router} from '@angular/router';\nimport {FooterType} from '@shared-lib/modules/footer/constants/footerType.enum';\nimport {FooterTypeService} from '@shared-lib/modules/footer/services/footer-type/footer-type.service';\nimport Swiper from 'swiper';\nimport {Status} from '@shared-lib/constants/status.enum';\nimport {\n  JourneyStep,\n  SwipeEnabledEvent,\n  ContinueEvent,\n  Journey,\n} from '@shared-lib/services/journey/models/journey.model';\nimport {JourneyService} from '@shared-lib/services/journey/journey.service';\nimport {Keyboard, KeyboardPlugin} from '@capacitor/keyboard';\nimport {ViewWillEnter, ViewWillLeave, ViewDidEnter} from '@ionic/angular';\nimport {ProgressBarStep} from '@shared-lib/components/step-progress-bar/models/step-progress-bar-model';\nimport {EventManagerService} from '@shared-lib/modules/event-manager/event-manager/event-manager.service';\nimport {Subscription} from 'rxjs';\nimport {eventKeys} from '@shared-lib/constants/event-keys';\nimport {EventTrackingService} from '@shared-lib/services/event-tracker/event-tracking.service';\nimport {SharedUtilityService} from '@shared-lib/services/utility/utility.service';\nimport {Publisher} from '@shared-lib/modules/event-manager/publisher';\n\n@Component({\n  selector: 'journeys-steps',\n  templateUrl: './steps.component.html',\n  styleUrls: ['./steps.component.scss'],\n})\nexport class StepsComponent\n  implements OnInit, ViewWillEnter, ViewWillLeave, ViewDidEnter {\n  @ViewChildren('journeyStep', {read: ElementRef}) stepEls: QueryList<\n    ElementRef\n  >;\n  currentStep = 0;\n  steps: JourneyStep[];\n  progressBarSteps: ProgressBarStep[];\n  journey: Journey;\n  slideOpts: Record<string, number | boolean | string> = {};\n  slides: Swiper;\n  keyboard: KeyboardPlugin = Keyboard;\n  private subscription = new Subscription();\n  private updateStatuses = true;\n  private refreshJourneyStatusPublisher: Publisher;\n  isWeb: boolean;\n  private scrollToTopPublisher: Publisher;\n  private swipeEnabledList: boolean[];\n  private stepToSave: number;\n  private saveLastStep = true;\n\n  constructor(\n    private footerService: FooterTypeService,\n    private journeyService: JourneyService,\n    private ngZone: NgZone,\n    private router: Router,\n    private eventManager: EventManagerService,\n    private eventTracking: EventTrackingService,\n    private utilityService: SharedUtilityService\n  ) {}\n\n  ngOnInit(): void {\n    this.isWeb = this.utilityService.getIsWeb();\n    this.slideOpts = this.isWeb\n      ? {\n          slidesPerView: 1,\n          centeredSlides: true,\n          spaceBetween: 50,\n          noSwipingSelector: 'ion-range',\n          longSwipes: true,\n          longSwipesMs: 100,\n          longSwipesRatio: 0.1,\n          shortSwipes: false,\n        }\n      : {\n          slidesPerView: 1.1,\n          centeredSlides: true,\n          spaceBetween: 10,\n          noSwipingSelector: 'ion-range',\n        };\n    this.subscription.add(\n      this.eventManager\n        .createSubscriber(eventKeys.leaveJourney)\n        .subscribe(() => {\n          this.leaveJourney();\n        })\n    );\n    this.refreshJourneyStatusPublisher = this.eventManager.createPublisher(\n      eventKeys.refreshJourneyStatus\n    );\n    this.scrollToTopPublisher = this.eventManager.createPublisher(\n      eventKeys.journeyStepsScrollToTop\n    );\n    this.subscription.add(\n      this.journeyService.fetchJourneys().subscribe(() => {\n        const currentJourney = this.journeyService.getCurrentJourney();\n        if (this.journey && this.journey !== currentJourney) {\n          this.journey = this.journeyService.getCurrentJourney();\n          this.steps = this.journey.steps;\n        }\n      })\n    );\n  }\n\n  ionViewWillEnter() {\n    this.footerService.publish({type: FooterType.none});\n    this.journeyService.publishSelectedTab('steps');\n    this.journey = this.journeyService.getCurrentJourney();\n    this.steps = this.journey.steps;\n    this.swipeEnabledList = Array(this.steps.length).fill(true);\n    this.progressBarSteps = JSON.parse(\n      JSON.stringify(Array(this.steps.length).fill({status: Status.notStarted}))\n    );\n    if (this.steps && this.steps.length > 0) {\n      this.updateStepStatuses(0, undefined, false);\n      if (this.isWeb) {\n        this.refreshJourneyStatusPublisher.publish(undefined);\n      }\n    }\n    this.journeyService.publishCurrentStep(this.currentStep);\n    this.saveLastStep = true;\n  }\n\n  ionViewDidEnter() {\n    setTimeout(() => {\n      this.slides.slideTo(this.journey.lastModifiedStepIndex, 0);\n      for (let i = 0; i < this.journey.lastModifiedStepIndex; i++) {\n        this.progressBarSteps[i] = {status: Status.completed};\n      }\n    }, 100);\n  }\n\n  setSwiperInstance(swiper: Swiper) {\n    this.slides = swiper;\n    if (this.swipeEnabledList) {\n      this.slides.allowTouchMove = this.swipeEnabledList[this.currentStep];\n    }\n  }\n\n  handleSlideChange() {\n    this.ngZone.run(() => {\n      this.keyboard.hide();\n      const currentStepIndex = this.slides\n        ? this.slides.activeIndex\n        : (this.slideOpts.initialSlide as number);\n      if (currentStepIndex === this.steps.length) {\n        this.updateStepStatuses(this.currentStep);\n        this.finishJourney();\n        return;\n      }\n      this.updateStepStatuses(currentStepIndex);\n      this.currentStep = currentStepIndex;\n      if (this.slides) {\n        this.slides.allowTouchMove = this.swipeEnabledList[this.currentStep];\n      }\n      this.journeyService.publishCurrentStep(this.currentStep);\n      if (this.isWeb) {\n        this.scrollToTopPublisher.publish(undefined);\n      }\n    });\n  }\n\n  updateStepStatuses(\n    newIndex: number,\n    prevIndex = this.currentStep,\n    isCompleted = true\n  ): void {\n    if (this.updateStatuses) {\n      const stepsToSave = [];\n      if (isCompleted) {\n        const completedStep = this.getUpdatedCompleteStep(prevIndex);\n        if (completedStep) {\n          stepsToSave.push(this.journeyService.removeContent(completedStep));\n        }\n      }\n\n      if (!this.steps[newIndex].status) {\n        if (newIndex === 0) {\n          this.eventTracking.eventTracking({\n            eventName: 'Journey Not Completed',\n            journeyID: this.journey.journeyID,\n            journeyName: this.journey.journeyName,\n          });\n        }\n        this.steps[newIndex].status = Status.inProgress;\n        stepsToSave.push(\n          this.journeyService.removeContent(this.steps[newIndex])\n        );\n      }\n      this.saveProgress(stepsToSave);\n      this.journeyService.updateJourneySteps(\n        this.steps,\n        this.journey.journeyID\n      );\n      if (newIndex > 0) {\n        this.progressBarSteps[newIndex - 1].status = Status.completed;\n      }\n      this.progressBarSteps[newIndex].status = Status.notStarted;\n    }\n    this.updateStatuses = true;\n  }\n\n  private getUpdatedCompleteStep(index: number): JourneyStep {\n    let journeyStep;\n    if (\n      this.steps[index].status !== Status.completed ||\n      this.steps[index].answer !== JSON.stringify(this.steps[index].value)\n    ) {\n      if (\n        this.steps[index].status !== Status.completed &&\n        index === this.steps.length - 1\n      ) {\n        this.eventTracking.eventTracking({\n          eventName: 'Journey Not Completed',\n          journeyID: this.journey.journeyID,\n          updateInd: 'Y',\n          journeyName: this.journey.journeyName,\n        });\n      }\n      this.steps[index].status = Status.completed;\n      if (this.steps[index].value && this.steps[index].value !== {})\n        this.steps[index].answer = JSON.stringify(this.steps[index].value);\n      journeyStep = this.steps[index];\n    }\n    return journeyStep;\n  }\n\n  saveProgress(steps: JourneyStep[]) {\n    if (steps.length > 0) {\n      this.journeyService.saveProgress(steps);\n    }\n  }\n\n  handleContinueClick(event: ContinueEvent) {\n    if (this.currentStep < this.steps.length - 1) {\n      this.slides.slideNext();\n    } else {\n      this.updateStepStatuses(this.currentStep);\n      if (event.route) {\n        this.finishJourney();\n      } else {\n        this.leaveJourney();\n      }\n    }\n  }\n\n  handleBackClick() {\n    if (this.currentStep !== 0) {\n      this.slides.slideTo(this.currentStep - 1);\n    }\n  }\n\n  finishJourney() {\n    this.stepToSave = 0;\n    this.leaveJourney();\n    if (this.journeyService.isSummaryStepCompleted()) {\n      if (!this.isWeb) {\n        this.router.navigateByUrl(\n          '/journeys/journey/' + this.journey.journeyID + '/overview'\n        );\n      } else {\n        this.refreshJourneyStatusPublisher.publish(undefined);\n        this.router.navigate(\n          ['/journeys/journey/' + this.journey.journeyID + '/overview'],\n          {\n            queryParams: {journeyType: 'all'},\n          }\n        );\n      }\n    } else {\n      this.router.navigateByUrl('/journeys');\n    }\n  }\n\n  scrollToTop() {\n    if (!this.isWeb) {\n      this.stepEls.get(this.currentStep).nativeElement.scrollIntoView({\n        behavior: 'auto',\n        block: 'center',\n        inline: 'end',\n      });\n    }\n  }\n\n  updateSwipeEnabled(swipeEnabledEvent: SwipeEnabledEvent) {\n    this.swipeEnabledList[swipeEnabledEvent.index] =\n      swipeEnabledEvent.swipeEnabled;\n    if (this.slides) {\n      this.slides.allowTouchMove = this.swipeEnabledList[this.currentStep];\n    }\n  }\n\n  leaveJourney() {\n    if (this.journey) {\n      this.journeyService.updateJourneySteps(\n        this.steps,\n        this.journey.journeyID\n      );\n      this.updateStatuses = false;\n      if (this.saveLastStep) {\n        this.saveLastStep = false;\n        const stepToSave =\n          this.stepToSave || this.stepToSave === 0\n            ? this.stepToSave\n            : this.currentStep;\n        this.saveProgress([\n          this.journeyService.removeContent(this.steps[stepToSave]),\n        ]);\n        this.journey.lastModifiedStepIndex = stepToSave;\n        this.journeyService.setCurrentJourney(this.journey, true);\n        this.stepToSave = undefined;\n      }\n    }\n  }\n\n  updateStep(value: Record<string, string | string[]>, i: number) {\n    this.steps[i].value = value;\n    this.journeyService.updateJourneySteps(\n      this.steps,\n      this.journey.journeyID,\n      false\n    );\n  }\n\n  ionViewWillLeave() {\n    this.leaveJourney();\n  }\n\n  ngOnDestroy() {\n    this.subscription.unsubscribe();\n    if (this.isWeb) {\n      this.leaveJourney();\n    }\n  }\n}\n","import {NgModule} from '@angular/core';\nimport {CommonModule} from '@angular/common';\nimport {IonicModule} from '@ionic/angular';\nimport {StepsComponent} from './steps.component';\nimport {StepsRoutingModule} from './steps-routing.module';\nimport {StepProgressBarComponentModule} from '@shared-lib/components/step-progress-bar/step-progress-bar.module';\nimport {SwiperModule} from 'swiper/angular';\nimport {StepModule} from './step/step.module';\nimport {ModalComponentModule} from '../../components/modal/modal.module';\n\n@NgModule({\n  declarations: [StepsComponent],\n  imports: [\n    IonicModule,\n    CommonModule,\n    StepsRoutingModule,\n    SwiperModule,\n    StepProgressBarComponentModule,\n    StepModule,\n    ModalComponentModule,\n  ],\n  schemas: [],\n})\nexport class StepsModule {}\n","import {Injectable} from '@angular/core';\nimport {endPoints} from '@shared-lib/services/account/constants/endpoints';\nimport {BaseService} from '@shared-lib/services/base/base-factory-provider';\nimport {SharedUtilityService} from '@shared-lib/services/utility/utility.service';\nimport {EventTrackingEvent, SFMCUserInfo} from './models/event-tracking.model';\n\n@Injectable({\n  providedIn: 'root',\n})\nexport class EventTrackingService {\n  endPoints = endPoints;\n  private subscriberKeyPromise: Promise<SFMCUserInfo>;\n\n  constructor(\n    private baseService: BaseService,\n    private utilityService: SharedUtilityService\n  ) {\n    this.endPoints = this.utilityService.appendBaseUrlToEndpoints(endPoints);\n  }\n\n  async eventTracking(postData: EventTrackingEvent): Promise<void> {\n    postData.createdBy = 'myvoyage';\n    postData.subscriberKey = (await this.getSubscriberKey()).subscriberKey;\n    postData.passThruAttributes = [\n      ...(postData.passThruAttributes || []),\n      {\n        attributeName: 'platform',\n        attributeValue: this.utilityService.getIsWeb() ? 'web' : 'mobile',\n      },\n    ];\n    await this.baseService.post(this.endPoints.eventTracking, postData);\n  }\n\n  getSubscriberKey(): Promise<SFMCUserInfo> {\n    if (!this.subscriberKeyPromise) {\n      this.subscriberKeyPromise = this.baseService.get(\n        this.endPoints.subscriberKey\n      );\n    }\n    return this.subscriberKeyPromise;\n  }\n}\n","export default \"<app-step-progress-bar\\n  [steps]=\\\"progressBarSteps\\\"\\n  [currentStep]=\\\"currentStep\\\"\\n></app-step-progress-bar>\\n<swiper\\n  [config]=\\\"slideOpts\\\"\\n  (swiper)=\\\"setSwiperInstance($event)\\\"\\n  (slideChange)=\\\"handleSlideChange()\\\"\\n  (slideChangeTransitionEnd)=\\\"scrollToTop()\\\"\\n>\\n  <ng-template swiperSlide *ngFor=\\\"let step of steps; let i = index\\\">\\n    <div class=\\\"steps-content\\\">\\n      <journeys-steps-step\\n        [index]=\\\"i\\\"\\n        [step]=\\\"step\\\"\\n        (continueClick)=\\\"handleContinueClick($event)\\\"\\n        (backClick)=\\\"handleBackClick()\\\"\\n        [currentStep]=\\\"currentStep\\\"\\n        [journeyId]=\\\"journey.journeyID\\\"\\n        (swipeEnabled)=\\\"updateSwipeEnabled($event)\\\"\\n        (updateStep)=\\\"updateStep($event, i)\\\"\\n        #journeyStep\\n      ></journeys-steps-step>\\n    </div>\\n  </ng-template>\\n  <ng-template swiperSlide><div></div></ng-template>\\n</swiper>\\n\";"]}