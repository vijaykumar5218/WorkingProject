{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport idCard from './constants/idCard.json';\nimport { card, upload_from } from './constants/camera.enum';\nimport { Camera, CameraResultType, CameraSource } from '@capacitor/camera';\nimport { trigger, state, style, transition, animate } from '@angular/animations';\nimport { Subscription } from 'rxjs';\nimport pageText from './card-modal/constants/pageText.json';\nimport { CardModalComponent } from './card-modal/card-modal.component';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@ionic/angular\";\nimport * as i2 from \"@shared-lib/services/utility/utility.service\";\nimport * as i3 from \"@angular/router\";\nimport * as i4 from \"@shared-lib/services/benefits/benefits.service\";\nimport * as i5 from \"@angular/common\";\n\nfunction MyIdCardComponent_div_7_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r4 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"div\");\n    i0.ɵɵelementStart(1, \"p\");\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"ion-button\", 5);\n    i0.ɵɵlistener(\"click\", function MyIdCardComponent_div_7_Template_ion_button_click_3_listener() {\n      i0.ɵɵrestoreView(_r4);\n      const ctx_r3 = i0.ɵɵnextContext();\n      return ctx_r3.addACard();\n    });\n    i0.ɵɵelement(4, \"ion-icon\", 6);\n    i0.ɵɵtext(5);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(ctx_r0.content.desc);\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.content.button, \" \");\n  }\n}\n\nfunction MyIdCardComponent_ng_template_8_img_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 18);\n  }\n\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"src\", ctx_r5.cardImage.cardFront, i0.ɵɵsanitizeUrl);\n  }\n}\n\nfunction MyIdCardComponent_ng_template_8_img_8_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"img\", 19);\n  }\n\n  if (rf & 2) {\n    const ctx_r6 = i0.ɵɵnextContext(2);\n    i0.ɵɵproperty(\"src\", ctx_r6.cardImage.cardBack, i0.ɵɵsanitizeUrl);\n  }\n}\n\nfunction MyIdCardComponent_ng_template_8_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"button\", 7);\n    i0.ɵɵlistener(\"click\", function MyIdCardComponent_ng_template_8_Template_button_click_0_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r7 = i0.ɵɵnextContext();\n      return ctx_r7.toggleFlip();\n    });\n    i0.ɵɵelement(1, \"img\", 8);\n    i0.ɵɵtext(2);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 9);\n    i0.ɵɵelementStart(4, \"div\", 10);\n    i0.ɵɵelementStart(5, \"div\", 11);\n    i0.ɵɵtemplate(6, MyIdCardComponent_ng_template_8_img_6_Template, 1, 1, \"img\", 12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(7, \"div\", 13);\n    i0.ɵɵtemplate(8, MyIdCardComponent_ng_template_8_img_8_Template, 1, 1, \"img\", 14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"div\", 15);\n    i0.ɵɵelementStart(10, \"button\", 16);\n    i0.ɵɵlistener(\"click\", function MyIdCardComponent_ng_template_8_Template_button_click_10_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r9 = i0.ɵɵnextContext();\n      return ctx_r9.addACard();\n    });\n    i0.ɵɵtext(11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(12, \"div\", 15);\n    i0.ɵɵelementStart(13, \"button\", 17);\n    i0.ɵɵlistener(\"click\", function MyIdCardComponent_ng_template_8_Template_button_click_13_listener() {\n      i0.ɵɵrestoreView(_r8);\n      const ctx_r10 = i0.ɵɵnextContext();\n      return ctx_r10.deleteImage();\n    });\n    i0.ɵɵtext(14);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.content.flipBtn, \" \");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"@flipState\", ctx_r2.flip);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.cardImage.cardFront !== \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngIf\", ctx_r2.cardImage.cardBack !== \"\");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.content.updateBtn, \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.content.deleteBtn, \" \");\n  }\n}\n\nexport let MyIdCardComponent = /*#__PURE__*/(() => {\n  class MyIdCardComponent {\n    constructor(loadingCtrl, actionSheetCtrl, utilService, router, modalController, benefit) {\n      this.loadingCtrl = loadingCtrl;\n      this.actionSheetCtrl = actionSheetCtrl;\n      this.utilService = utilService;\n      this.router = router;\n      this.modalController = modalController;\n      this.benefit = benefit;\n      this.content = idCard;\n      this.cardImage = {\n        cardFront: '',\n        cardBack: ''\n      };\n      this.camera = Camera;\n      this.flip = 'front';\n      this.subscription = new Subscription();\n      this.deleteContent = pageText;\n      this.firstLoad = true;\n    }\n\n    ngOnChanges(changes) {\n      if (changes.benefitId) {\n        this.setCardImages();\n      }\n    }\n\n    addACard() {\n      if (this.utilService.getIsWeb()) {\n        const selectedBenefit = this.benefit.getSelectedBenefit();\n        this.router.navigateByUrl('/coverages/view-plans/' + selectedBenefit.id + '/details/add-card');\n      } else {\n        this.presentActionSheet();\n      }\n    }\n\n    setCardImages() {\n      var _a, _b;\n\n      if (this.benefitId && this.benefitCards) {\n        this.cardImage.cardFront = ((_a = this.benefitCards[this.benefitId]) === null || _a === void 0 ? void 0 : _a.cardFront) || '';\n        this.cardImage.cardBack = ((_b = this.benefitCards[this.benefitId]) === null || _b === void 0 ? void 0 : _b.cardBack) || '';\n\n        if (this.cardImage.cardFront === '' && this.cardImage.cardBack === '' && this.firstLoad) {\n          this.benefit.getIdCard();\n        }\n\n        this.firstLoad = false;\n      }\n    }\n\n    ngOnInit() {\n      this.subscription.add(this.benefit.getCardImages().subscribe(res => {\n        this.benefitCards = res;\n        this.setCardImages();\n      }));\n      this.subscription.add(this.benefit.getFlipCardSubject().subscribe(res => {\n        this.flip = res;\n      }));\n    }\n\n    openSource(type) {\n      return __awaiter(this, void 0, void 0, function* () {\n        try {\n          const image = yield this.camera.getPhoto({\n            quality: 90,\n            allowEditing: true,\n            source: type === upload_from.CAMERA ? CameraSource.Camera : CameraSource.Photos,\n            resultType: CameraResultType.Base64\n          });\n          return image;\n        } catch (error) {\n          return undefined;\n        }\n      });\n    }\n\n    checkPermissionAndRequest(type) {\n      return __awaiter(this, void 0, void 0, function* () {\n        const permission = yield this.camera.checkPermissions();\n        const permissionType = type === upload_from.CAMERA ? 'camera' : 'photos';\n        let result = yield this.checkPermission(permission, type);\n\n        if (!result && permission[permissionType] !== 'denied') {\n          const requestPermission = yield this.camera.requestPermissions({\n            permissions: [permissionType]\n          });\n          result = yield this.checkPermission(requestPermission, type);\n        }\n\n        return result;\n      });\n    }\n\n    checkPermission(permission, type) {\n      return __awaiter(this, void 0, void 0, function* () {\n        let result = false;\n\n        if (permission[type] === 'granted' || permission[type] === 'limited') {\n          result = true;\n        } else if (permission[type] === 'denied') {\n          const header = (type === 'camera' ? 'Camera' : 'Photo library') + ' permission is denied';\n          const description = 'Please enable ' + (type === 'camera' ? 'camera' : 'photo library') + ' permission from the device settings of the app to use this feature.';\n          this.showModal({\n            yesText: 'Okay',\n            description: description,\n            header: header\n          });\n        }\n\n        return result;\n      });\n    }\n\n    presentActionSheet() {\n      return __awaiter(this, void 0, void 0, function* () {\n        const actionSheet = yield this.actionSheetCtrl.create({\n          buttons: [{\n            text: idCard.actionsheet.fromPhotos,\n            handler: () => {\n              this.startLoader(card.FRONT, upload_from.PHOTOS);\n            }\n          }, {\n            text: idCard.actionsheet.fromCamera,\n            handler: () => {\n              this.startLoader(card.FRONT, upload_from.CAMERA);\n            }\n          }, {\n            text: idCard.actionsheet.cancel,\n            role: 'cancel'\n          }]\n        });\n        yield actionSheet.present();\n      });\n    }\n\n    startLoader(cardSide, type) {\n      return __awaiter(this, void 0, void 0, function* () {\n        const permission = yield this.checkPermissionAndRequest(type);\n\n        if (permission) {\n          this.load(cardSide, type);\n        }\n      });\n    }\n\n    load(cardSide, type) {\n      return __awaiter(this, void 0, void 0, function* () {\n        const loaderMessage = type === upload_from.CAMERA ? idCard.loaderMessagefromCamera : idCard.loaderMessagefromPhotos;\n        const loading = yield this.loadingCtrl.create({\n          message: loaderMessage.replace('$cardSide', cardSide),\n          showBackdrop: true,\n          cssClass: 'card-overlay'\n        });\n        loading.present().then(() => __awaiter(this, void 0, void 0, function* () {\n          setTimeout(() => __awaiter(this, void 0, void 0, function* () {\n            const image = yield this.openSource(type);\n\n            if (image) {\n              if (cardSide === card.FRONT) {\n                this.cardImage.cardFront = image.base64String ? image.base64String : '';\n                yield this.startLoader(card.BACK, type);\n              }\n\n              this.setCardBack(cardSide, image);\n            }\n\n            loading.dismiss();\n          }), 5000);\n        }));\n      });\n    }\n\n    setCardBack(cardSide, image) {\n      if (cardSide === card.BACK) {\n        this.cardImage.cardBack = image.base64String ? image.base64String : '';\n\n        if (this.cardImage.cardFront !== '' && this.cardImage.cardBack !== '') {\n          this.benefit.uploadMyIdCard(this.cardImage);\n        }\n      }\n    }\n\n    toggleFlip() {\n      this.benefit.flipCard(this.flip);\n    }\n\n    showModal(componentProps) {\n      return __awaiter(this, void 0, void 0, function* () {\n        const modal = yield this.modalController.create({\n          component: CardModalComponent,\n          cssClass: 'modal-not-fullscreen',\n          swipeToClose: false,\n          componentProps: componentProps\n        });\n        modal.present();\n      });\n    }\n\n    deleteImage() {\n      this.showModal({\n        header: this.deleteContent.titleMessage,\n        yesText: this.deleteContent.yes,\n        noText: this.deleteContent.no,\n        delete: true\n      });\n    }\n\n    ngOnDestroy() {\n      this.subscription.unsubscribe();\n    }\n\n  }\n\n  MyIdCardComponent.ɵfac = function MyIdCardComponent_Factory(t) {\n    return new (t || MyIdCardComponent)(i0.ɵɵdirectiveInject(i1.LoadingController), i0.ɵɵdirectiveInject(i1.ActionSheetController), i0.ɵɵdirectiveInject(i2.SharedUtilityService), i0.ɵɵdirectiveInject(i3.Router), i0.ɵɵdirectiveInject(i1.ModalController), i0.ɵɵdirectiveInject(i4.BenefitsService));\n  };\n\n  MyIdCardComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: MyIdCardComponent,\n    selectors: [[\"app-my-id-card\"]],\n    inputs: {\n      benefitId: \"benefitId\"\n    },\n    features: [i0.ɵɵNgOnChangesFeature],\n    decls: 10,\n    vars: 3,\n    consts: [[1, \"ion-text-start\", \"dependents-head\"], [1, \"background\"], [\"automation-id\", \"app-my-id-card-header\"], [4, \"ngIf\", \"ngIfElse\"], [\"cardBlock\", \"\"], [\"automation-id\", \"app-my-id-card-button\", 3, \"click\"], [\"slot\", \"start\", \"name\", \"add-circle-outline\", 1, \"font\"], [\"slot\", \"start\", \"fill\", \"clear\", \"automation-id\", \"flip-btn\", 1, \"btn-primary\", 3, \"click\"], [\"src\", \"assets/icon/account-type/flip.svg\", \"alt\", \"flip-btn\", 1, \"img-flip\"], [1, \"tp-wrapper\"], [1, \"tp-box\"], [1, \"tp-box__side\", \"tp-box__front\"], [\"alt\", \"card front\", 3, \"src\", 4, \"ngIf\"], [1, \"tp-box__side\", \"tp-box__back\"], [\"alt\", \"card back\", 3, \"src\", 4, \"ngIf\"], [1, \"text-center\"], [\"slot\", \"start\", \"fill\", \"clear\", \"automation-id\", \"update-btn\", 1, \"btn-sec\", \"update\", 3, \"click\"], [\"slot\", \"start\", \"fill\", \"clear\", \"automation-id\", \"delete-btn\", 1, \"btn-sec\", \"delete\", 3, \"click\"], [\"alt\", \"card front\", 3, \"src\"], [\"alt\", \"card back\", 3, \"src\"]],\n    template: function MyIdCardComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\");\n        i0.ɵɵelementStart(1, \"ion-row\");\n        i0.ɵɵelementStart(2, \"ion-col\");\n        i0.ɵɵelementStart(3, \"div\", 0);\n        i0.ɵɵelementStart(4, \"div\", 1);\n        i0.ɵɵelementStart(5, \"ion-text\", 2);\n        i0.ɵɵtext(6);\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(7, MyIdCardComponent_div_7_Template, 6, 2, \"div\", 3);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵtemplate(8, MyIdCardComponent_ng_template_8_Template, 15, 6, \"ng-template\", null, 4, i0.ɵɵtemplateRefExtractor);\n      }\n\n      if (rf & 2) {\n        const _r1 = i0.ɵɵreference(9);\n\n        i0.ɵɵadvance(6);\n        i0.ɵɵtextInterpolate1(\" \", ctx.content.header, \" \");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.cardImage.cardFront === \"\" && ctx.cardImage.cardBack === \"\")(\"ngIfElse\", _r1);\n      }\n    },\n    directives: [i1.IonRow, i1.IonCol, i1.IonText, i5.NgIf, i1.IonButton, i1.IonIcon],\n    styles: [\".dependents-head[_ngcontent-%COMP%]{flex-grow:0;font-size:18px;font-weight:700;line-height:1.33;letter-spacing:.03px;color:var(--primary-colors-voya-black);margin-top:10px}@media screen and (min-width: 768px){.dependents-head[_ngcontent-%COMP%]{padding:0 36px}}.dependents-head[_ngcontent-%COMP%]   .background[_ngcontent-%COMP%]{background-color:var(--white);border-radius:8px;padding:20px 20px 32px}.dependents-head[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-top:10px;font-size:14px;font-weight:400}.dependents-head[_ngcontent-%COMP%]   ion-button[_ngcontent-%COMP%]{display:block;margin:auto;width:160px;--border-radius: 25px;color:var(--primary-colors-voya-white);font-weight:600;--background: var(--primary-colors-voya-dark-blue)}.tp-wrapper[_ngcontent-%COMP%]{perspective:800px;width:50%;margin:auto}.tp-wrapper[_ngcontent-%COMP%]   .tp-box[_ngcontent-%COMP%]{position:relative;width:100%;height:200px;margin:50px auto;transform-style:preserve-3d;transform:transform 1s;box-shadow:8px 4px 12px 4px #00000040;background-color:var(--primary-colors-voya-white);border-radius:15px}.tp-wrapper[_ngcontent-%COMP%]   .tp-box[_ngcontent-%COMP%]   .tp-box__side[_ngcontent-%COMP%]{width:100%;height:100%;position:absolute;display:flex;justify-content:center;align-items:center;backface-visibility:hidden;-webkit-user-select:none;-moz-user-select:none;user-select:none}.tp-wrapper[_ngcontent-%COMP%]   .tp-box[_ngcontent-%COMP%]   .tp-box__side[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{max-width:100%;max-height:100%}.tp-wrapper[_ngcontent-%COMP%]   .tp-box[_ngcontent-%COMP%]   .tp-box__front[_ngcontent-%COMP%]{transform:rotateY(0)}.tp-wrapper[_ngcontent-%COMP%]   .tp-box[_ngcontent-%COMP%]   .tp-box__back[_ngcontent-%COMP%]{transform:rotateY(-180deg)}.btn-primary[_ngcontent-%COMP%]{font-size:20px;font-weight:bold;text-align:right;float:right;color:var(--primary-colors-voya-dark-blue);margin-top:25px;background:none}.btn-primary[_ngcontent-%COMP%]   .img-flip[_ngcontent-%COMP%]{margin-right:4px}.btn-sec[_ngcontent-%COMP%]{width:100px;height:40px;font-size:16px;color:var(--primary-colors-voya-dark-blue)}.btn-sec.update[_ngcontent-%COMP%]{border-radius:20px;border:2px solid var(--primary-colors-voya-dark-blue);background:var(--primary-colors-voya-white)}.btn-sec.delete[_ngcontent-%COMP%]{background:none;-webkit-text-decoration-line:underline;text-decoration-line:underline}\"],\n    data: {\n      animation: [trigger('flipState', [state('back', style({\n        transform: 'rotateY(179deg)'\n      })), state('front', style({\n        transform: 'rotateY(0)'\n      })), transition('back => front', animate('500ms ease-out')), transition('front => back', animate('500ms ease-in'))])]\n    }\n  });\n  return MyIdCardComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}