(function(){var t=function(t){var e=/^https?:\/\/[^\/]+/i,i=t.url&&t.url.match(e)?t.url.match(e)[0]:null;this.options=t||{},this.options.version="1.1.0",this.options.autoload=void 0===t.autoload||t.autoload,this.options.id=t.id||"md-widget",this.options.postMessageOrigin=t.postMessageOrigin||i||"https://widgets.moneydesktop.com",this.options.autoload&&window.addEventListener("load",function(){this.load()}.bind(this),!1),window.addEventListener("message",this.onPostMessage.bind(this),!1)};t.prototype.load=function(t){var e=document.getElementById(this.options.id),i=this.options.deepLink?"#"+this.options.deepLink:"",o=t||this.options.url,s=this.options.width||"100%",n=this.options.height||"600",a=this.options.title||"MoneyMap",r=document.createElement("iframe");r.setAttribute("width",s),r.setAttribute("height",n),r.setAttribute("border","0"),r.setAttribute("frame","0"),r.setAttribute("frameborder","0"),r.setAttribute("allowTransparency","true"),r.setAttribute("src",o+i),r.setAttribute("marginheight","0"),r.setAttribute("marginwidth","0"),r.setAttribute("title",a),e.innerHTML="",e.appendChild(r),r.addEventListener("load",(function(){e.className+=" md-widget-loaded"}),!1),this.iframeDetails={iframe:r,loaded:!1,targetElement:e},this.options.config&&(this.configInterval=setInterval(function(){this.iframeDetails.loaded?clearInterval(this.configInterval):this.postMessageToMoneyDesktop({type:"clientConfig",data:this.options.config})}.bind(this),100),setTimeout(function(){clearInterval(this.configInterval)}.bind(this),5e3))},t.prototype.onPostMessage=function(t){var e=!1;if(this.iframeDetails&&this.iframeDetails.iframe&&t.source===this.iframeDetails.iframe.contentWindow){try{e=JSON.parse(t.data),console.log("onPostMessage :::::",e.type)}catch(t){}e&&e.moneyDesktop&&"load"===e.type&&(this.iframeDetails.loaded=!0)}},t.prototype.postMessageToMoneyDesktop=function(t){this.iframeDetails.iframe.contentWindow.postMessage(JSON.stringify(t),this.options.postMessageOrigin),console.log("postMessageToMoneyDesktop :::::",t)},t.prototype.logout=function(){this.postMessageToMoneyDesktop({type:"logout"})},t.prototype.ping=function(){console.log("postMessageToMoneyDesktop ping():::::",{type:"ping"}),this.postMessageToMoneyDesktop({type:"ping"})},window.MoneyDesktopWidgetLoader=t}).call(this);