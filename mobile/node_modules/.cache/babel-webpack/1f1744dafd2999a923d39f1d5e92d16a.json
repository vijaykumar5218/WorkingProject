{"ast":null,"code":"import { EventEmitter } from '@angular/core';\nimport * as journeyContent from '@shared-lib/services/journey/constants/journey-content.json';\nimport { Status } from '@shared-lib/constants/status.enum';\nimport { Subscription } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@shared-lib/services/journey/journey.service\";\nimport * as i2 from \"@angular/router\";\nimport * as i3 from \"@shared-lib/services/utility/utility.service\";\nimport * as i4 from \"@shared-lib/services/platform/platform.service\";\nimport * as i5 from \"@angular/common\";\nimport * as i6 from \"@ionic/angular\";\nimport * as i7 from \"./summary-card/summary-card.component\";\nimport * as i8 from \"./step/step.component\";\n\nfunction SummaryComponent_span_1_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 6);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r0.journey.parsedLandingAndOverviewContent.overview.summaryHeader);\n  }\n}\n\nfunction SummaryComponent_span_2_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"span\", 7);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate(ctx_r1.journey.parsedLandingAndOverviewContent.overview.summaryDescription);\n  }\n}\n\nfunction SummaryComponent_journeys_overview_summary_card_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelement(0, \"journeys-overview-summary-card\", 8);\n  }\n\n  if (rf & 2) {\n    const summaryCard_r4 = ctx.$implicit;\n    const i_r5 = ctx.index;\n    i0.ɵɵproperty(\"summaryCard\", summaryCard_r4)(\"index\", i_r5);\n  }\n}\n\nconst _c0 = function (a0) {\n  return {\n    \"margin-bottom\": a0\n  };\n};\n\nfunction SummaryComponent_ng_container_5_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r8 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementContainerStart(0);\n    i0.ɵɵelementStart(1, \"journeys-overview-summary-step\", 9);\n    i0.ɵɵlistener(\"valueChange\", function SummaryComponent_ng_container_5_Template_journeys_overview_summary_step_valueChange_1_listener($event) {\n      const restoredCtx = i0.ɵɵrestoreView(_r8);\n      const summaryStep_r6 = restoredCtx.$implicit;\n      const ctx_r7 = i0.ɵɵnextContext();\n      return ctx_r7.updateValue($event, summaryStep_r6.answerId);\n    });\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementContainerEnd();\n  }\n\n  if (rf & 2) {\n    const summaryStep_r6 = ctx.$implicit;\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"step\", summaryStep_r6)(\"journeyId\", ctx_r3.journey.journeyID)(\"answer\", ctx_r3.value && ctx_r3.value[summaryStep_r6.answerId])(\"ngStyle\", i0.ɵɵpureFunction1(4, _c0, summaryStep_r6.marginBottom));\n  }\n}\n\nexport let SummaryComponent = /*#__PURE__*/(() => {\n  class SummaryComponent {\n    constructor(journeyService, router, activatedRoute, utilityService, platformService) {\n      this.journeyService = journeyService;\n      this.router = router;\n      this.activatedRoute = activatedRoute;\n      this.utilityService = utilityService;\n      this.platformService = platformService;\n      this.content = journeyContent;\n      this.showRevisit = false;\n      this.buttonLabel = this.content.overviewDoneButton;\n      this.summaryStepList = [];\n      this.subscription = new Subscription();\n      this.valueChange = new EventEmitter();\n      this.platformService.isDesktop().subscribe(data => {\n        this.isDesktop = data;\n      });\n      this.isWeb = this.utilityService.getIsWeb();\n    }\n\n    ngOnChanges(simpleChanges) {\n      if (simpleChanges.journey) {\n        this.updateForJourney();\n      }\n    }\n\n    updateForJourney() {\n      this.summaryStepList = [];\n      this.setRevisitButton();\n      this.processSteps();\n      const firstStepParsedAnswer = this.journeyService.safeParse(this.journey.steps[0].answer);\n      this.value = this.journeyService.safeParse(firstStepParsedAnswer === null || firstStepParsedAnswer === void 0 ? void 0 : firstStepParsedAnswer.summary) || {};\n    }\n\n    setRevisitButton() {\n      const status = this.journeyService.getJourneyStatus(this.journey.steps);\n\n      if (!this.isWeb) {\n        const fromJourneys = this.activatedRoute.snapshot.paramMap.get('fromJourneys');\n        this.changingBtnLabel(status, fromJourneys);\n      } else {\n        const activatedRouteSubscription = this.activatedRoute.queryParams.subscribe(data => {\n          this.journeyType = data.journeyType;\n          this.changingBtnLabel(status, data.fromJourneys);\n        });\n        this.subscription.add(activatedRouteSubscription);\n      }\n    }\n\n    changingBtnLabel(status, fromJourneys) {\n      if (status === Status.completed && fromJourneys) {\n        this.showRevisit = true;\n        this.buttonLabel = this.content.overviewRevisitButton;\n      }\n    }\n\n    processSteps() {\n      this.journey.parsedLandingAndOverviewContent.overview.summarySteps.forEach((summaryStep, i) => {\n        summaryStep.idSuffix = i.toString();\n        let finalSummaryStep = Object.assign({}, summaryStep);\n\n        if ('journeyStepName' in summaryStep) {\n          const step = this.journey.steps.find(journeyStep => journeyStep.journeyStepName === summaryStep.journeyStepName);\n          finalSummaryStep = Object.assign(Object.assign({}, finalSummaryStep), {\n            stepContent: step.content,\n            answer: this.journeyService.safeParse(step.answer),\n            status: step.status\n          });\n        }\n\n        this.summaryStepList.push(finalSummaryStep);\n      });\n    }\n\n    handleButtonClick() {\n      if (this.showRevisit) {\n        if (!this.isWeb) {\n          this.router.navigateByUrl('/journeys/journey/' + this.journey.journeyID + '/steps');\n        } else {\n          this.router.navigate(['/journeys/journey/' + this.journey.journeyID + '/steps'], {\n            queryParams: {\n              journeyType: this.journeyType\n            }\n          });\n          this.showRevisit = false;\n          this.buttonLabel = this.content.overviewDoneButton;\n        }\n      } else {\n        if (!this.isDesktop && this.isWeb) {\n          this.router.navigateByUrl('/journeys-list');\n        } else {\n          this.router.navigateByUrl('/journeys');\n        }\n      }\n    }\n\n    updateValue(value, answerId) {\n      this.value[answerId] = value;\n      this.valueChange.emit(JSON.stringify(this.value));\n    }\n\n    ngOnDestroy() {\n      this.subscription.unsubscribe();\n    }\n\n  }\n\n  SummaryComponent.ɵfac = function SummaryComponent_Factory(t) {\n    return new (t || SummaryComponent)(i0.ɵɵdirectiveInject(i1.JourneyService), i0.ɵɵdirectiveInject(i2.Router), i0.ɵɵdirectiveInject(i2.ActivatedRoute), i0.ɵɵdirectiveInject(i3.SharedUtilityService), i0.ɵɵdirectiveInject(i4.PlatformService));\n  };\n\n  SummaryComponent.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: SummaryComponent,\n    selectors: [[\"journeys-overview-summary\"]],\n    inputs: {\n      journey: \"journey\"\n    },\n    outputs: {\n      valueChange: \"valueChange\"\n    },\n    features: [i0.ɵɵNgOnChangesFeature],\n    decls: 8,\n    vars: 6,\n    consts: [[3, \"ngClass\"], [\"class\", \"header\", 4, \"ngIf\"], [\"class\", \"desc\", 4, \"ngIf\"], [3, \"summaryCard\", \"index\", 4, \"ngFor\", \"ngForOf\"], [4, \"ngFor\", \"ngForOf\"], [\"name\", \"submit\", \"shape\", \"round\", \"expand\", \"block\", \"type\", \"submit\", \"color\", \"btncolor\", \"id\", \"overviewSummaryButton\", 1, \"font-18\", \"save-button\", 3, \"click\"], [1, \"header\"], [1, \"desc\"], [3, \"summaryCard\", \"index\"], [3, \"step\", \"journeyId\", \"answer\", \"ngStyle\", \"valueChange\"]],\n    template: function SummaryComponent_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵelementStart(0, \"div\", 0);\n        i0.ɵɵtemplate(1, SummaryComponent_span_1_Template, 2, 1, \"span\", 1);\n        i0.ɵɵtemplate(2, SummaryComponent_span_2_Template, 2, 1, \"span\", 2);\n        i0.ɵɵtemplate(3, SummaryComponent_journeys_overview_summary_card_3_Template, 1, 2, \"journeys-overview-summary-card\", 3);\n        i0.ɵɵelementStart(4, \"ion-card\");\n        i0.ɵɵtemplate(5, SummaryComponent_ng_container_5_Template, 2, 6, \"ng-container\", 4);\n        i0.ɵɵelementStart(6, \"ion-button\", 5);\n        i0.ɵɵlistener(\"click\", function SummaryComponent_Template_ion_button_click_6_listener() {\n          return ctx.handleButtonClick();\n        });\n        i0.ɵɵtext(7);\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n        i0.ɵɵelementEnd();\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngClass\", ctx.isWeb ? \"web-summary\" : \"mobile-summary\");\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.journey.parsedLandingAndOverviewContent.overview.summaryHeader);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngIf\", ctx.journey.parsedLandingAndOverviewContent.overview.summaryDescription);\n        i0.ɵɵadvance(1);\n        i0.ɵɵproperty(\"ngForOf\", ctx.journey.parsedLandingAndOverviewContent.overview.summaryCards);\n        i0.ɵɵadvance(2);\n        i0.ɵɵproperty(\"ngForOf\", ctx.summaryStepList);\n        i0.ɵɵadvance(2);\n        i0.ɵɵtextInterpolate(ctx.buttonLabel);\n      }\n    },\n    directives: [i5.NgClass, i5.NgIf, i5.NgForOf, i6.IonCard, i6.IonButton, i7.SummaryCardComponent, i8.SummaryStepComponent, i5.NgStyle],\n    styles: [\"[_nghost-%COMP%]{display:block}[_nghost-%COMP%]   span[_ngcontent-%COMP%]{padding-left:40px;padding-right:40px;color:var(--primary-colors-voya-black);display:block}[_nghost-%COMP%]   span.header[_ngcontent-%COMP%]{font-size:24px;font-weight:600;padding-top:42.5px}[_nghost-%COMP%]   span.desc[_ngcontent-%COMP%]{font-size:16px}[_nghost-%COMP%]   journeys-overview-summary-step[_ngcontent-%COMP%]{margin-bottom:30px}[_nghost-%COMP%]   ion-button[_ngcontent-%COMP%]{height:40px;color:var(--primary-colors-voya-white);font-weight:normal;font-size:16px;width:60%;margin:auto}[_nghost-%COMP%]   .web-summary[_ngcontent-%COMP%]{margin-bottom:100px}[_nghost-%COMP%]   .web-summary[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{box-shadow:none;margin:0}@media screen and (max-width: 920px){[_nghost-%COMP%]   .web-summary[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{padding:20px}}@media screen and (min-width: 920px){[_nghost-%COMP%]   .web-summary[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{padding:36px}}[_nghost-%COMP%]   .web-summary[_ngcontent-%COMP%]   ion-button.save-button[_ngcontent-%COMP%]{max-width:220px}[_nghost-%COMP%]   .mobile-summary[_ngcontent-%COMP%]   ion-card[_ngcontent-%COMP%]{padding:20px;overflow:visible}\"]\n  });\n  return SummaryComponent;\n})();","map":null,"metadata":{},"sourceType":"module"}