{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport * as eventC from '@shared-lib/services/event-tracker/constants/event-tracking.json';\nimport { take } from 'rxjs/operators';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"@shared-lib/services/pushNotifications/pushNotifications.service\";\nimport * as i2 from \"@shared-lib/services/event-tracker/event-tracking.service\";\nimport * as i3 from \"@shared-lib/services/qualtrics/qualtrics.service\";\nimport * as i4 from \"@shared-lib/services/account/account.service\";\nimport * as i5 from \"../google-Analytics/google.analytics.service\";\nimport * as i6 from \"../notification-setting/notification-setting.service\";\nexport let HomeService = /*#__PURE__*/(() => {\n  class HomeService {\n    constructor(pushNotificationsService, eventTrackingService, qualtricsService, accountService, googleAnalyticsService, settingsService) {\n      this.pushNotificationsService = pushNotificationsService;\n      this.eventTrackingService = eventTrackingService;\n      this.qualtricsService = qualtricsService;\n      this.accountService = accountService;\n      this.googleAnalyticsService = googleAnalyticsService;\n      this.settingsService = settingsService;\n      this.eventContent = eventC;\n      this.contactKeySet = false;\n    }\n\n    trackHomeEvent() {\n      this.eventTrackingService.eventTracking({\n        eventName: this.eventContent.eventTrackingLogin.eventName\n      });\n    }\n\n    setSFMCContactKey() {\n      return __awaiter(this, void 0, void 0, function* () {\n        if (!this.contactKeySet) {\n          this.contactKeySet = true;\n          const subscriberKeyInfo = yield this.eventTrackingService.getSubscriberKey();\n          this.pushNotificationsService.setContactKey(subscriberKeyInfo.subscriberKey);\n        }\n      });\n    }\n\n    setQualtricsProps() {\n      this.accountService.getParticipant().subscribe(data => {\n        this.qualtricsService.setUserProperties(data);\n      });\n    }\n\n    getPartyId() {\n      return __awaiter(this, void 0, void 0, function* () {\n        const result = yield this.googleAnalyticsService.getQualtricsUser();\n        return result === null || result === void 0 ? void 0 : result.partyId;\n      });\n    }\n\n    getEmail() {\n      var _a;\n\n      return __awaiter(this, void 0, void 0, function* () {\n        const result = yield this.settingsService.getNotificationSettings().pipe(take(1)).toPromise();\n        return (_a = result === null || result === void 0 ? void 0 : result.primaryEmail) === null || _a === void 0 ? void 0 : _a.email;\n      });\n    }\n\n    initializeAppForUser() {\n      this.setSFMCContactKey();\n      this.setQualtricsProps();\n      this.trackHomeEvent();\n    }\n\n  }\n\n  HomeService.ɵfac = function HomeService_Factory(t) {\n    return new (t || HomeService)(i0.ɵɵinject(i1.PushNotificationsService), i0.ɵɵinject(i2.EventTrackingService), i0.ɵɵinject(i3.QualtricsService), i0.ɵɵinject(i4.AccountService), i0.ɵɵinject(i5.GoogleAnalyticsService), i0.ɵɵinject(i6.NotificationsSettingService));\n  };\n\n  HomeService.ɵprov = /*@__PURE__*/i0.ɵɵdefineInjectable({\n    token: HomeService,\n    factory: HomeService.ɵfac,\n    providedIn: 'root'\n  });\n  return HomeService;\n})();","map":null,"metadata":{},"sourceType":"module"}