{"ast":null,"code":"import { __awaiter } from \"tslib\";\nimport { FooterType } from '@shared-lib/modules/footer/constants/footerType.enum';\nimport * as landingText from './constants/landing-content.json';\nimport { Status } from '@shared-lib/constants/status.enum';\nimport { Subscription } from 'rxjs';\nimport { HeaderType } from '@shared-lib/constants/headerType.enum';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../shared/service/authentication/authentication.service\";\nimport * as i2 from \"@shared-lib/services/header-footer-type/headerFooterType.service\";\nimport * as i3 from \"./service/landing.service\";\nimport * as i4 from \"@angular/router\";\nimport * as i5 from \"@ionic/angular\";\nimport * as i6 from \"@shared-lib/services/home/home.service\";\nimport * as i7 from \"../../../../../../shared-lib/services/access/access.service\";\nimport * as i8 from \"@angular/common\";\nimport * as i9 from \"swiper/angular\";\nimport * as i10 from \"../../../../../../shared-lib/components/step-progress-bar/step-progress-bar.component\";\n\nfunction LandingPage_ion_grid_0_10_ng_template_0_a_6_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r10 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"a\", 23);\n    i0.ɵɵlistener(\"click\", function LandingPage_ion_grid_0_10_ng_template_0_a_6_Template_a_click_0_listener() {\n      i0.ɵɵrestoreView(_r10);\n      const step_r3 = i0.ɵɵnextContext(2).$implicit;\n      const ctx_r8 = i0.ɵɵnextContext(2);\n      return ctx_r8.openLink(step_r3.login_description[0].link_url);\n    });\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const step_r3 = i0.ɵɵnextContext(2).$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", step_r3.login_description[0].link_name, \"\");\n  }\n}\n\nfunction LandingPage_ion_grid_0_10_ng_template_0_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 18);\n    i0.ɵɵelement(1, \"img\", 19);\n    i0.ɵɵelementStart(2, \"ion-text\", 20);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"ion-text\", 21);\n    i0.ɵɵtext(5);\n    i0.ɵɵtemplate(6, LandingPage_ion_grid_0_10_ng_template_0_a_6_Template, 2, 1, \"a\", 22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const step_r3 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵpropertyInterpolate(\"src\", step_r3.login_description[0].image_url, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate(step_r3.login_title);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\" \", step_r3.login_description[0].description, \" \");\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", step_r3.login_description[0].link_name);\n  }\n}\n\nfunction LandingPage_ion_grid_0_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵtemplate(0, LandingPage_ion_grid_0_10_ng_template_0_Template, 7, 4, \"ng-template\", 16, 17, i0.ɵɵtemplateRefExtractor);\n  }\n}\n\nfunction LandingPage_ion_grid_0_ion_row_14_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r14 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"ion-row\", 24);\n    i0.ɵɵelementStart(1, \"ion-col\");\n    i0.ɵɵelement(2, \"img\", 25);\n    i0.ɵɵelementStart(3, \"ion-text\", 26);\n    i0.ɵɵlistener(\"click\", function LandingPage_ion_grid_0_ion_row_14_Template_ion_text_click_3_listener() {\n      i0.ɵɵrestoreView(_r14);\n      const ctx_r13 = i0.ɵɵnextContext(2);\n      return ctx_r13.loginFaceID();\n    });\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(2);\n    i0.ɵɵpropertyInterpolate(\"src\", ctx_r2.biometricsIcon, i0.ɵɵsanitizeUrl);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate2(\"\", ctx_r2.pageText.signInWith, \"\", ctx_r2.biometricsText, \"\");\n  }\n}\n\nconst _c0 = function (a0) {\n  return {\n    \"width\": a0\n  };\n};\n\nfunction LandingPage_ion_grid_0_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r16 = i0.ɵɵgetCurrentView();\n\n    i0.ɵɵelementStart(0, \"ion-grid\", 1);\n    i0.ɵɵelementStart(1, \"ion-row\", 2);\n    i0.ɵɵelementStart(2, \"ion-col\");\n    i0.ɵɵelementStart(3, \"ion-text\", 3);\n    i0.ɵɵtext(4);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(5, \"ion-row\", 4);\n    i0.ɵɵelementStart(6, \"ion-col\", 5);\n    i0.ɵɵelementStart(7, \"div\", 6);\n    i0.ɵɵelement(8, \"img\", 7);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"swiper\", 8);\n    i0.ɵɵlistener(\"swiper\", function LandingPage_ion_grid_0_Template_swiper_swiper_9_listener($event) {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r15 = i0.ɵɵnextContext();\n      return ctx_r15.setSwiperInstance($event);\n    })(\"slideChange\", function LandingPage_ion_grid_0_Template_swiper_slideChange_9_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r17 = i0.ɵɵnextContext();\n      return ctx_r17.handleSlideChange();\n    });\n    i0.ɵɵtemplate(10, LandingPage_ion_grid_0_10_Template, 2, 0, undefined, 9);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(11, \"ion-row\", 10);\n    i0.ɵɵelementStart(12, \"ion-col\");\n    i0.ɵɵelement(13, \"app-step-progress-bar\", 11);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(14, LandingPage_ion_grid_0_ion_row_14_Template, 5, 3, \"ion-row\", 12);\n    i0.ɵɵelementStart(15, \"ion-row\", 13);\n    i0.ɵɵelementStart(16, \"ion-col\", 13);\n    i0.ɵɵelementStart(17, \"ion-button\", 14);\n    i0.ɵɵlistener(\"click\", function LandingPage_ion_grid_0_Template_ion_button_click_17_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r18 = i0.ɵɵnextContext();\n      return ctx_r18.signInClicked();\n    });\n    i0.ɵɵtext(18);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(19, \"ion-row\", 13);\n    i0.ɵɵelementStart(20, \"ion-col\", 13);\n    i0.ɵɵelementStart(21, \"ion-button\", 15);\n    i0.ɵɵlistener(\"click\", function LandingPage_ion_grid_0_Template_ion_button_click_21_listener() {\n      i0.ɵɵrestoreView(_r16);\n      const ctx_r19 = i0.ɵɵnextContext();\n      return ctx_r19.registerClicked();\n    });\n    i0.ɵɵtext(22);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementEnd();\n  }\n\n  if (rf & 2) {\n    const ctx_r0 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(4);\n    i0.ɵɵtextInterpolate(ctx_r0.pageText.welcome);\n    i0.ɵɵadvance(5);\n    i0.ɵɵproperty(\"config\", ctx_r0.slideOpts)(\"ngStyle\", i0.ɵɵpureFunction1(11, _c0, ctx_r0.pageWidth));\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r0.landingSteps);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"steps\", ctx_r0.landingSteps)(\"currentStep\", ctx_r0.currentStep);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r0.hasFaceIDSession);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"disabled\", ctx_r0.signInDisabled);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.pageText.signin, \" \");\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"disabled\", ctx_r0.signInDisabled);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r0.pageText.register, \" \");\n  }\n}\n\nexport let LandingPage = /*#__PURE__*/(() => {\n  class LandingPage {\n    constructor(authService, headerFooterTypeService, landingService, ngZone, route, loadingController, homeService, accessService) {\n      this.authService = authService;\n      this.headerFooterTypeService = headerFooterTypeService;\n      this.landingService = landingService;\n      this.ngZone = ngZone;\n      this.route = route;\n      this.loadingController = loadingController;\n      this.homeService = homeService;\n      this.accessService = accessService;\n      this.pageText = landingText;\n      this.firstTimeLoad = true;\n      this.hasFaceIDSession = false;\n      this.slideOpts = {\n        slidesPerView: 1,\n        centeredSlides: true\n      };\n      this.currentStep = 0;\n      this.reloading = false;\n      this.subscription = new Subscription();\n      this.signInDisabled = false;\n    }\n\n    ngOnInit() {\n      this.subscription.add(this.authService.authenticationChange$.subscribe(this.authenticationChanged.bind(this)));\n      this.subscription.add(this.authService.biometricsAuthenticationChange$.subscribe(this.biometricsAuthenticationChanged.bind(this)));\n    }\n\n    ionViewWillEnter() {\n      return __awaiter(this, void 0, void 0, function* () {\n        this.reloading = this.authService.reloading;\n        this.headerFooterTypeService.publishType({\n          type: HeaderType.none\n        }, {\n          type: FooterType.none\n        });\n        this.landingSteps = (yield this.landingService.getLandingContent()).MobileLaunchContent;\n        this.landingSteps[0].status = Status.completed;\n        this.pageWidth = window.innerWidth * 0.8 + 'px';\n        this.biometricsIcon = yield this.authService.getBiometricsIconName();\n        this.biometricsText = yield this.authService.getBiometricsLabel();\n        this.checkFaceIdSession();\n        this.route.queryParams.subscribe(params => __awaiter(this, void 0, void 0, function* () {\n          if (this.firstTimeLoad && !(params === null || params === void 0 ? void 0 : params.noAutoLogin)) {\n            yield this.authService.attemptFaceIDLogin();\n            this.firstTimeLoad = false; //If has prev non-faceid session. Revoke old tokens.\n\n            this.checkOldSessionAndRevoke();\n          }\n        }));\n        this.landingService.openVersionAlert();\n      });\n    }\n\n    checkFaceIdSession() {\n      return __awaiter(this, void 0, void 0, function* () {\n        try {\n          this.hasFaceIDSession = yield this.authService.hasFaceIDSession();\n        } catch (ex) {\n          this.hasFaceIDSession = false;\n        }\n      });\n    }\n\n    biometricsAuthenticationChanged(isAuth) {\n      if (isAuth) {\n        this.homeService.initializeAppForUser();\n      }\n    }\n\n    authenticationChanged(isAuth) {\n      return __awaiter(this, void 0, void 0, function* () {\n        if (isAuth.auth && !isAuth.attested) {\n          const loading = yield this.loadingController.create({\n            translucent: true\n          });\n          loading.present();\n          const valid = yield this.landingService.validateApplication();\n\n          if (!valid) {\n            alert(this.pageText.failedAttest);\n            yield this.authService.logoutAndRevoke();\n            loading.dismiss();\n            return;\n          }\n\n          this.authService.onAuthChange({\n            auth: true,\n            attested: true\n          });\n          const result = yield this.landingService.checkMyvoyageAccess();\n          this.accessService.checkLastPreferenceUpdated();\n\n          if (result.enableMyVoyage === 'Y') {\n            this.homeService.initializeAppForUser();\n            const show = yield this.authService.shouldShowBiometricsScreen();\n\n            if (show) {\n              this.landingService.navigateByUrl('biometrics');\n            } else {\n              this.authService.navigateToLoggedInLanding();\n            }\n          } else {\n            this.landingService.navigateByUrl('no-access');\n          }\n\n          loading.dismiss();\n        }\n      });\n    }\n\n    checkOldSessionAndRevoke() {\n      return __awaiter(this, void 0, void 0, function* () {\n        const hasSession = yield this.authService.hasNonFaceIDSession();\n\n        if (hasSession) {\n          yield this.authService.logoutAndRevoke();\n        }\n      });\n    }\n\n    loginFaceID() {\n      this.authService.attemptFaceIDLogin();\n    }\n\n    signInClicked() {\n      return __awaiter(this, void 0, void 0, function* () {\n        this.signInDisabled = true;\n        const loading = yield this.loadingController.create({\n          translucent: true\n        });\n        loading.present();\n        yield this.authService.openLogin();\n        this.checkFaceIdSession();\n        loading.dismiss();\n        this.signInDisabled = false;\n      });\n    }\n\n    registerClicked() {\n      return __awaiter(this, void 0, void 0, function* () {\n        this.signInDisabled = true;\n        const loading = yield this.loadingController.create({\n          translucent: true\n        });\n        loading.present();\n        yield this.authService.openRegister();\n        this.checkFaceIdSession();\n        loading.dismiss();\n        this.signInDisabled = false;\n      });\n    }\n\n    setSwiperInstance(swiper) {\n      this.slides = swiper;\n    }\n\n    openLink(url) {\n      this.landingService.openInBrowser(url);\n    }\n\n    handleSlideChange() {\n      this.ngZone.run(() => {\n        this.currentStep = this.slides.activeIndex;\n        this.landingSteps[this.currentStep].status = Status.completed;\n\n        if (this.currentStep + 1 < this.landingSteps.length) {\n          this.landingSteps[this.currentStep + 1].status = Status.notStarted;\n        }\n      });\n    }\n\n    ngOnDestroy() {\n      this.subscription.unsubscribe();\n    }\n\n  }\n\n  LandingPage.ɵfac = function LandingPage_Factory(t) {\n    return new (t || LandingPage)(i0.ɵɵdirectiveInject(i1.AuthenticationService), i0.ɵɵdirectiveInject(i2.HeaderFooterTypeService), i0.ɵɵdirectiveInject(i3.LandingService), i0.ɵɵdirectiveInject(i0.NgZone), i0.ɵɵdirectiveInject(i4.ActivatedRoute), i0.ɵɵdirectiveInject(i5.LoadingController), i0.ɵɵdirectiveInject(i6.HomeService), i0.ɵɵdirectiveInject(i7.AccessService));\n  };\n\n  LandingPage.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n    type: LandingPage,\n    selectors: [[\"app-landing\"]],\n    decls: 1,\n    vars: 1,\n    consts: [[\"class\", \"p-0\", \"class\", \"container\", 4, \"ngIf\"], [1, \"container\"], [1, \"top-row\"], [1, \"welcome\"], [1, \"logo-row\"], [1, \"logo-col\"], [1, \"logo-div\"], [\"src\", \"assets/icon/myVoyageNew_Mobile.svg\", \"alt\", \"voya logo\", 1, \"logo\"], [\"id\", \"swiper-container\", 3, \"config\", \"ngStyle\", \"swiper\", \"slideChange\"], [4, \"ngFor\", \"ngForOf\"], [1, \"progress-row\"], [3, \"steps\", \"currentStep\"], [\"class\", \"face-id-row\", 4, \"ngIf\"], [1, \"p-0\"], [\"name\", \"submit\", \"shape\", \"round\", \"expand\", \"block\", \"type\", \"submit\", \"color\", \"btncolor\", \"id\", \"sign-in-button\", 1, \"sign-in\", 3, \"disabled\", \"click\"], [\"name\", \"submit\", \"shape\", \"round\", \"expand\", \"block\", \"type\", \"submit\", \"color\", \"white\", \"fill\", \"outline\", \"id\", \"register-button\", 1, \"register\", 3, \"disabled\", \"click\"], [\"swiperSlide\", \"\"], [\"swiper\", \"\"], [1, \"page-container\"], [\"alt\", \"\", 1, \"slide-img\", 3, \"src\"], [1, \"page-title\"], [1, \"page-desc\"], [3, \"click\", 4, \"ngIf\"], [3, \"click\"], [1, \"face-id-row\"], [\"alt\", \"biometrics\", 1, \"bio-icon\", 3, \"src\"], [1, \"bio-text\", 3, \"click\"]],\n    template: function LandingPage_Template(rf, ctx) {\n      if (rf & 1) {\n        i0.ɵɵtemplate(0, LandingPage_ion_grid_0_Template, 23, 13, \"ion-grid\", 0);\n      }\n\n      if (rf & 2) {\n        i0.ɵɵproperty(\"ngIf\", !ctx.reloading);\n      }\n    },\n    directives: [i8.NgIf, i5.IonGrid, i5.IonRow, i5.IonCol, i5.IonText, i9.SwiperComponent, i8.NgStyle, i8.NgForOf, i10.StepProgressBarComponent, i5.IonButton, i9.SwiperSlideDirective],\n    styles: [\"[_nghost-%COMP%]{background-color:var(--primary-colors-voya-white)}@keyframes rotate-compass{0%{opacity:0;transform:translate(15%) rotate(0) scale(5)}5%{opacity:1;transform:translate(15%) scale(5)}10%{transform:translate(15%) scale(5)}20%{transform:translate(15%) rotate(-90deg) scale(5)}60%{transform:translate(0) rotate(90deg) scale(1)}to{transform:translate(0) rotate(0)}}@keyframes fade-in{0%{opacity:0}60%{opacity:0}to{opacity:1}}[_nghost-%COMP%]   .container[_ngcontent-%COMP%]{height:100%}@media screen and (max-height: 700px){[_nghost-%COMP%]   .top-row[_ngcontent-%COMP%]{margin-top:12px;margin-bottom:8px}[_nghost-%COMP%]   .top-row.ios[_ngcontent-%COMP%]{margin-top:20px}[_nghost-%COMP%]   .page-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:50%}}[_nghost-%COMP%]   .top-row[_ngcontent-%COMP%]{margin-bottom:12px;height:24px;font-size:18px;line-height:1.33;letter-spacing:.03px;text-align:center;color:var(--primary-colors-voya-black)}@media screen and (min-height: 700px){[_nghost-%COMP%]   .top-row[_ngcontent-%COMP%]{margin-top:40px}[_nghost-%COMP%]   .top-row.ios[_ngcontent-%COMP%]{margin-top:70px}}[_nghost-%COMP%]   #swiper-container[_ngcontent-%COMP%]{animation:fade-in 2.5s ease-in-out both;margin-bottom:20px;height:35%}[_nghost-%COMP%]   .swiper-slide[_ngcontent-%COMP%]{display:flex;flex-direction:column!important}[_nghost-%COMP%]   .page-container[_ngcontent-%COMP%]{display:flex;flex-direction:column;height:100%;width:100%}[_nghost-%COMP%]   .page-container[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{min-height:0;flex-shrink:1;margin:auto auto 10px}[_nghost-%COMP%]   .page-container[_ngcontent-%COMP%]   .page-title[_ngcontent-%COMP%]{font-size:16px;font-weight:bold;letter-spacing:.02px;margin-bottom:8px;margin-top:8px;color:var(--primary-colors-voya-black)}[_nghost-%COMP%]   .page-container[_ngcontent-%COMP%]   .page-desc[_ngcontent-%COMP%]{font-size:16px;font-weight:normal;letter-spacing:.08px;text-align:left;color:var(--primary-colors-voya-black)}[_nghost-%COMP%]   .page-container[_ngcontent-%COMP%]   .page-desc[_ngcontent-%COMP%]   a[_ngcontent-%COMP%]{color:var(--primary-colors-voya-dark-blue)}[_nghost-%COMP%]   .welcome[_ngcontent-%COMP%]{display:block;margin:auto;text-align:center;font-size:18px;letter-spacing:.03px;color:var(--primary-colors-voya-black);animation:fade-in 2.5s ease-in-out both}[_nghost-%COMP%]   .logo-col[_ngcontent-%COMP%]{margin:20px auto 5%}[_nghost-%COMP%]   .logo-col[_ngcontent-%COMP%]   .logo-div[_ngcontent-%COMP%]{display:block;width:292px;height:89.3px;margin:auto}[_nghost-%COMP%]   .logo-col[_ngcontent-%COMP%]   .logo-div[_ngcontent-%COMP%]   .logo[_ngcontent-%COMP%]{position:absolute;top:0px;left:50%;transform:translate(-50%);width:292px;height:89.3px;animation:fade-in 2.5s ease-in-out both}[_nghost-%COMP%]   .logo-col[_ngcontent-%COMP%]   .logo-div[_ngcontent-%COMP%]   .compass[_ngcontent-%COMP%]{height:46.5px;width:46.5px;position:absolute;top:0;left:calc(50% - 39px);transform:translate(-50%);animation:rotate-compass 2.5s ease-in-out both}[_nghost-%COMP%]   .progress-row[_ngcontent-%COMP%]{animation:fade-in 2.5s ease-in-out both}[_nghost-%COMP%]   .face-id-row[_ngcontent-%COMP%]{margin-top:20px;font-size:16px;line-height:1.25;letter-spacing:.08px;color:var(--primary-colors-voya-dark-blue);animation:fade-in 2.5s ease-in-out both;text-align:center}[_nghost-%COMP%]   .face-id-row[_ngcontent-%COMP%]   .bio-icon[_ngcontent-%COMP%]{height:20px;width:20px;display:inline-block;vertical-align:bottom;margin-right:8px}[_nghost-%COMP%]   .face-id-row[_ngcontent-%COMP%]   .bio-text[_ngcontent-%COMP%]{display:inline-block;text-align:center}[_nghost-%COMP%]   ion-button[_ngcontent-%COMP%]{display:block;width:220px;height:40px;margin:20px auto 0;animation:fade-in 2.5s ease-in-out both}[_nghost-%COMP%]   ion-button.register[_ngcontent-%COMP%]{--border-color: var(--primary-colors-voya-dark-blue);--border-width: 2px}\"]\n  });\n  return LandingPage;\n})();","map":null,"metadata":{},"sourceType":"module"}